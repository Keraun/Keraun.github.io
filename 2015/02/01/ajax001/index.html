<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Ajax | 竹醉月的小小羊</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=no">
  <meta name="description" content="前言前段时间群里做知识分享,大豹老师分享了他对Ajax的一些心得体会,当时听的比较入迷,整理了一些笔记,希望对大家有帮助。
知识目录结构
Ajax 基础知识
jQuery中Ajax的相关用法
jQuery中Ajax全局设置和全局事件
表单数据序列化
实际应用中的注意事项
知识扩展
参考资料">
<meta property="og:type" content="article">
<meta property="og:title" content="Ajax">
<meta property="og:url" content="http://iwuly.com/2015/02/01/ajax001/index.html">
<meta property="og:site_name" content="竹醉月的小小羊">
<meta property="og:description" content="前言前段时间群里做知识分享,大豹老师分享了他对Ajax的一些心得体会,当时听的比较入迷,整理了一些笔记,希望对大家有帮助。
知识目录结构
Ajax 基础知识
jQuery中Ajax的相关用法
jQuery中Ajax全局设置和全局事件
表单数据序列化
实际应用中的注意事项
知识扩展
参考资料">
<meta property="og:updated_time" content="2016-06-19T04:46:38.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ajax">
<meta name="twitter:description" content="前言前段时间群里做知识分享,大豹老师分享了他对Ajax的一些心得体会,当时听的比较入迷,整理了一些笔记,希望对大家有帮助。
知识目录结构
Ajax 基础知识
jQuery中Ajax的相关用法
jQuery中Ajax全局设置和全局事件
表单数据序列化
实际应用中的注意事项
知识扩展
参考资料">
  
    <link rel="alternate" href="/atom.xml" title="竹醉月的小小羊" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
  <style>
    @font-face {
      font-family: 'Source Code Pro';
      font-style: normal;
      font-weight: 400;
      src: url(./fonts/mrl8jkM18OlOQN8JLgasD90tugusXa58UbOrParLRF0.eot);
    }
  </style>
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="//hm.baidu.com/hm.js?7d8c9a345fc10798560981191ca49852" async ></script>

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">竹醉月的小小羊</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">不卑不亢 踏实进取</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">主页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/snippets">实验室</a>
        
          <a class="main-nav-link" href="/about">关于我</a>
        
          <a class="main-nav-link" href="/links">友链</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
        <a id="nav-about-btn" class=""  href="/about" title="iwuly">
          <img src="/css/images/gravatar.jpg" class="me"/>
        </a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://iwuly.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-ajax001" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    
      <a href="/2015/02/01/ajax001/" class="article-date">
  <time datetime="2015-02-01T13:05:54.000Z" itemprop="datePublished">2015年02月01日</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Ajax
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h4><p>前段时间群里做知识分享,<a href="http://www.cnblogs.com/lvdabao/" target="_blank" rel="external">大豹</a>老师分享了他对Ajax的一些心得体会,当时听的比较入迷,整理了一些笔记,希望对大家有帮助。</p>
<h4 id="u77E5_u8BC6_u76EE_u5F55_u7ED3_u6784"><a href="#u77E5_u8BC6_u76EE_u5F55_u7ED3_u6784" class="headerlink" title="知识目录结构"></a>知识目录结构</h4><ul>
<li>Ajax 基础知识</li>
<li>jQuery中Ajax的相关用法</li>
<li>jQuery中Ajax全局设置和全局事件</li>
<li>表单数据序列化</li>
<li>实际应用中的注意事项</li>
<li>知识扩展</li>
<li>参考资料<a id="more"></a>
</li>
</ul>
<h3 id="1_Ajax__u57FA_u7840_u77E5_u8BC6"><a href="#1_Ajax__u57FA_u7840_u77E5_u8BC6" class="headerlink" title="1 Ajax 基础知识"></a>1 Ajax 基础知识</h3><h4 id="1-1_Ajax_u662F_u4EC0_u4E48"><a href="#1-1_Ajax_u662F_u4EC0_u4E48" class="headerlink" title="1.1 Ajax是什么"></a>1.1 Ajax是什么</h4><p>Ajax的全称是Asyncronous Javascript And XML(异步传输JavaScript+XML)</p>
<ul>
<li>直白地说,就是没用Ajax的页面,你点一个按钮就要刷新一下页面,尽管新页面上只有一行和当前页面不一样,但还是要无聊地等待页面刷新。</li>
<li>用了Ajax之后再点击,然后页面上的一行就变化了,页面本身不用刷新。(简称页面无刷新数据交互)</li>
<li>Ajax只是一种技术,不是某种具体的东西。不同的浏览器有自己的实现的Ajax的组件。</li>
<li>XML只是一种数据格式,在这里并不重要,现在大部分人用JSON格式代替XML,原因是JSON更加简洁,解析速度也更快。</li>
</ul>
<p><strong>总结: 只要是JS调用异步通讯组件并使用格式化的数据来更新web页面上的内容或操作过程,那么我们用的方法就可算是Ajax。</strong></p>
<h4 id="1-2__u540C_u6B65_u548C_u5F02_u6B65"><a href="#1-2__u540C_u6B65_u548C_u5F02_u6B65" class="headerlink" title="1.2 同步和异步"></a>1.2 同步和异步</h4><p>javascript是单线程的，代码始终自上往下依次执行。</p>
<p>可以异步执行的代码：Ajax、setTimeout、setInterval。</p>
<h4 id="1-3__u5F02_u6B65_u8BF7_u6C42_u6709_u4EC0_u4E48_u7528_u9014_uFF1F"><a href="#1-3__u5F02_u6B65_u8BF7_u6C42_u6709_u4EC0_u4E48_u7528_u9014_uFF1F" class="headerlink" title="1.3 异步请求有什么用途？"></a>1.3 异步请求有什么用途？</h4><ol>
<li>制作单页面应用，用户操作不进行跳转、每次只更新局部内容</li>
<li>表单即时校验，如文本框失去焦点立即检验</li>
<li>进行前后端分离，后端只关注数据</li>
<li>定时异步请求（轮询），实现伪实时效果，如在线聊天室</li>
<li>异步加载多级数据，如树形结构、多级联动菜单、分页</li>
<li>……</li>
</ol>
<p><strong>问题：前端如何处理大数据？</strong><br>解析：前端数据再大，还是要向服务器端请求数据，浏览器还是要解析，其实没法从根本上解决问题。如果页面上的dom节点多了，浏览器可能就处理不过来，造成浏览器假死现象。<br>一个方案就是：异步加载完这些数据，来进行异步处理，这样可以减轻浏览器的压力。</p>
<h4 id="1-4__u5F02_u6B65_u8BF7_u6C42_u7684_u4F18_u7F3A_u70B9"><a href="#1-4__u5F02_u6B65_u8BF7_u6C42_u7684_u4F18_u7F3A_u70B9" class="headerlink" title="1.4 异步请求的优缺点"></a>1.4 异步请求的优缺点</h4><p><strong>优点：</strong><br> 1.不会阻塞当前正在进行的任务。<br> 2.局部刷新，避免页面跳转，用户体验更好<br> 3.减少请求数据的大小，加载更快<br> 4.有利于前后端分离，后端只关注数据</p>
<p><strong>缺陷：</strong><br> 1.毁坏浏览器前进后退按钮的功能<br> 2.不利于SEO<br> 3.无法跨域</p>
<p>这些都有相应的解决方法</p>
<h4 id="1-5__u8BA4_u8BC6XMLHttpRequest_u5BF9_u8C61"><a href="#1-5__u8BA4_u8BC6XMLHttpRequest_u5BF9_u8C61" class="headerlink" title="1.5 认识XMLHttpRequest对象"></a>1.5 认识XMLHttpRequest对象</h4><p>我们可以创建一个实例,并在控制台里面打印</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="built_in">console</span>.log(xhr);</span><br></pre></td></tr></table></figure>
<p>认识几个重要的字段,方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 字段</span><br><span class="line">onreadystatechange:<span class="literal">null</span>  请求的状态发生变化时的属性</span><br><span class="line">readyState:<span class="number">0</span> 请求的状态</span><br><span class="line">responseText:<span class="string">""</span> 服务器返回的东西</span><br><span class="line">status:<span class="number">0</span>   对应http状态码</span><br><span class="line">textStatus 会告诉你error的类型</span><br><span class="line"><span class="number">2.</span> 原型方法</span><br><span class="line">abort() 取消请求。</span><br><span class="line">open() 建立一个连接</span><br><span class="line">send() 发送请求</span><br><span class="line">setRequestHeader() 设置请求头部</span><br></pre></td></tr></table></figure>
<h4 id="1-6__u539F_u751Fajax_u5199_u6CD5"><a href="#1-6__u539F_u751Fajax_u5199_u6CD5" class="headerlink" title="1.6 原生ajax写法"></a>1.6 原生ajax写法</h4><p>需要注意的是原生XMLHttpRequest不兼容低版本IE6及以下,所以还需要考虑低版本的IE的兼容性。<br>兼容IE6的写法: ActiveXObject(‘Microsoft.XMLHTTP’)。<br>兼容IE5的写法: ActiveXObject(‘MSXML2.XMLHTTP’)。</p>
<p>以下是做了兼容性处理的原生请求的创建:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createXMLHTTPRequest</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//1.创建XMLHttpRequest对象   </span></span><br><span class="line">  <span class="comment">//这是XMLHttpReuquest对象无部使用中最复杂的一步   </span></span><br><span class="line">  <span class="comment">//需要针对IE和其他类型的浏览器建立这个对象的不同方式写不同的代码   </span></span><br><span class="line">  <span class="keyword">var</span> xhr;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</span><br><span class="line">    <span class="comment">//针对FireFox，Mozillar，Opera，Safari，IE7，IE8   </span></span><br><span class="line">    xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">//针对某些特定版本的mozillar浏览器的BUG进行修正   </span></span><br><span class="line">    <span class="keyword">if</span> (xhr.overrideMimeType) &#123;</span><br><span class="line">      xhr.overrideMimeType(<span class="string">"text/xml"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.ActiveXObject) &#123;</span><br><span class="line">    <span class="comment">//针对IE6，IE5.5，IE5   </span></span><br><span class="line">    <span class="comment">//两个可以用于创建XMLHTTPRequest对象的控件名称，保存在一个js的数组中   </span></span><br><span class="line">    <span class="comment">//排在前面的版本较新   </span></span><br><span class="line">    <span class="keyword">var</span> activexName = [<span class="string">"Microsoft.XMLHTTP"</span>,<span class="string">"MSXML2.XMLHTTP"</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; activexName.length; i++) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//取出一个控件名进行创建，如果创建成功就终止循环   </span></span><br><span class="line">        <span class="comment">//如果创建失败，回抛出异常，然后可以继续循环，继续尝试创建   </span></span><br><span class="line">        xhr = <span class="keyword">new</span> ActiveXObject(activexName[i]);</span><br><span class="line">        <span class="keyword">if</span> (xhr) &#123;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>GET请求用法:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> req = createXMLHTTPRequest();</span><br><span class="line"><span class="keyword">if</span> (req) &#123;</span><br><span class="line">  req.open(<span class="string">"GET"</span>, <span class="string">"http://test.com/?keywords=test"</span>, <span class="literal">true</span>);</span><br><span class="line">  req.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (req.status == <span class="number">200</span>) &#123;</span><br><span class="line">        alert(<span class="string">"success"</span>);</span><br><span class="line">        <span class="comment">//主动释放,js本身也会回收</span></span><br><span class="line">        xhr = <span class="literal">null</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        alert(<span class="string">"error"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  req.send(<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>POST请求用法:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> req = createXMLHTTPRequest();</span><br><span class="line"><span class="keyword">if</span>(req)&#123;</span><br><span class="line">  req.open(<span class="string">"POST"</span>, <span class="string">"http://test.com/"</span>, <span class="literal">true</span>);</span><br><span class="line">  <span class="comment">//post请求需要设置请求头</span></span><br><span class="line">  req.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/x-www-form-urlencoded"</span>);   </span><br><span class="line">  req.send(<span class="string">"keywords=test"</span>);</span><br><span class="line">  req.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.readyState == <span class="number">4</span>)&#123;</span><br><span class="line">      <span class="keyword">if</span>(req.status == <span class="number">200</span>)&#123;</span><br><span class="line">        alert(<span class="string">"success"</span>);</span><br><span class="line">        <span class="comment">//主动释放,js本身也会回收</span></span><br><span class="line">        xhr = <span class="literal">null</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        alert(<span class="string">"error"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>readyState值说明:请求分5个阶段,每个阶段有对应的readyState的值:</strong></p>
<ul>
<li>0-未初始化，send方法未调用</li>
<li>1-正在发送请求，send方法已调用</li>
<li>2-请求发送完毕，send方法执行完毕</li>
<li>3-正在解析响应内容(可以接收到部分响应数据)</li>
<li>4-响应内容解析完毕(数据接收完毕并且连接已经关闭)</li>
</ul>
<p><strong>status值说明:通常是用来判断服务器方的状态:</strong></p>
<ul>
<li>100——客户必须继续发出请求</li>
<li>101——客户要求服务器根据请求转换HTTP协议版本</li>
<li>200——成功</li>
<li>201——提示知道新文件的URL</li>
<li>300——请求的资源可在多处得到</li>
<li>301——删除请求数据</li>
<li>404——没有发现文件、查询或URl</li>
<li>500——服务器产生内部错误</li>
</ul>
<h3 id="2_jQuery_u4E2D_u7684ajax"><a href="#2_jQuery_u4E2D_u7684ajax" class="headerlink" title="2 jQuery中的ajax"></a>2 jQuery中的ajax</h3><p>jQuery中的ajax原理就是对原生的请求方法做了进一步封装和兼容性处理,包装成常用的方法:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$.ajax()</span><br><span class="line">$.get()</span><br><span class="line">$.post()</span><br><span class="line">$.getJSON()</span><br><span class="line">$.getScript()</span><br><span class="line">$.fn.load()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    url:<span class="string">'请求地址'</span>,</span><br><span class="line">    type:<span class="string">'GET/POST'</span>,</span><br><span class="line">    <span class="keyword">async</span>: <span class="literal">true</span>/<span class="literal">false</span>, <span class="comment">//是否异步</span></span><br><span class="line">    data: &#123;&#125;,<span class="comment">//发送的数据</span></span><br><span class="line">    timeout: <span class="string">'5000'</span>,<span class="comment">//超时时间</span></span><br><span class="line">    dataType: <span class="string">'json/xml/html/script/json/jsonp/text'</span></span><br><span class="line">    <span class="comment">//返回的数据格式</span></span><br><span class="line">    beforeSend: <span class="function"><span class="keyword">function</span>(<span class="params">xhr</span>)</span>&#123;&#125;,<span class="comment">//发送请求前</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span>(<span class="params">data, textStatus, jqXHR</span>)</span>&#123;&#125;,<span class="comment">//请求成功</span></span><br><span class="line">    error: <span class="function"><span class="keyword">function</span>(<span class="params">xhr, textStatus</span>)</span>&#123;&#125;,<span class="comment">//请求失败</span></span><br><span class="line">    complete: <span class="function"><span class="keyword">function</span>(<span class="params">xhr, testStatus</span>)</span>&#123;&#125;,<span class="comment">//请求结束</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>通常情况下使用$.ajax,因为他稍微更底层一点，可配置性高一点，可控性也高一点，效率也高一些。</p>
<h3 id="3_Ajax_u4E2D_u7684_u5168_u5C40_u914D_u7F6E_u548C_u5168_u5C40_u4E8B_u4EF6"><a href="#3_Ajax_u4E2D_u7684_u5168_u5C40_u914D_u7F6E_u548C_u5168_u5C40_u4E8B_u4EF6" class="headerlink" title="3 Ajax中的全局配置和全局事件"></a>3 Ajax中的全局配置和全局事件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$.ajaxSetup(&#123;</span><br><span class="line">      type: <span class="string">'POST'</span>,</span><br><span class="line">      timeout:<span class="string">'6000'</span>,</span><br><span class="line">      data: &#123;name: <span class="string">'abc'</span>&#125;,</span><br><span class="line">      dataType: <span class="string">'json'</span>,</span><br><span class="line">      beforSend: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'loading...'</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      error: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          alert(<span class="string">'请求失败，请重试！'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ajaxStart(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* Stuff to do when an AJAX call is started and no other AJAX calls are in progress */</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxSend(<span class="function"><span class="keyword">function</span>(<span class="params">event, xhr, settings</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* stuff to do before an AJAX request is sent */</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxSuccess(<span class="function"><span class="keyword">function</span>(<span class="params">event, xhr, settings</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* executes whenever an AJAX request completes successfully */</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxError(<span class="function"><span class="keyword">function</span>(<span class="params">event, xhr, settings, thrownError</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* Stuff to do when an AJAX call returns an error */</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxComplete(<span class="function"><span class="keyword">function</span>(<span class="params">event, xhr, settings</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* executes whenever an AJAX request completes */</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxStop((<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* stuff to do when all AJAX calls have completed */</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以通过Ajax全局事件写一个漂亮的显示请求进度的<a href="http://iwuly.com/snippets/?searchId=001">DEMO</a></p>
<h3 id="4-1__u8868_u5355_u6570_u636E_u5E8F_u5217_u5316"><a href="#4-1__u8868_u5355_u6570_u636E_u5E8F_u5217_u5316" class="headerlink" title="4.1 表单数据序列化"></a>4.1 表单数据序列化</h3><p><strong>作用：</strong><br>1.异步提交表单，免去跳转<br>2.快速获取表单数据<br>jQuery中的方法<br>serializ()//序列化为字符串<br>serializeArray()//序列化为数组</p>
<p>这两个不是jQuery中的方法<br>IE7以下需要引入JSON2文件<br>JSON对象呢在HTML5里面已经列为标准了呢。IE6还不能支持。所以还需要依赖JSON2文件<br>JSON.parse()//json字符串转化为json对象<br>JSON.stringify()//json对象转为json字符串</p>
<h3 id="5__u5B9E_u9645_u5E94_u7528_u4E2D_u7684_u6CE8_u610F_u4E8B_u9879"><a href="#5__u5B9E_u9645_u5E94_u7528_u4E2D_u7684_u6CE8_u610F_u4E8B_u9879" class="headerlink" title="5 实际应用中的注意事项"></a>5 实际应用中的注意事项</h3><h4 id="5-1__u51FD_u6570return_u5F02_u6B65_u6570_u636E_uFF0C_u53D6_u4E0D_u5230_u7684_u95EE_u9898"><a href="#5-1__u51FD_u6570return_u5F02_u6B65_u6570_u636E_uFF0C_u53D6_u4E0D_u5230_u7684_u95EE_u9898" class="headerlink" title="5.1 函数return异步数据，取不到的问题"></a>5.1 函数return异步数据，取不到的问题</h4><p>可以设置为同步请求，或者返回promise。</p>
<h4 id="5-2__u540C_u6B65Ajax_u8BF7_u6C42_u9020_u6210_u7684UI_u7EBF_u7A0B_u963B_u585E_u95EE_u9898"><a href="#5-2__u540C_u6B65Ajax_u8BF7_u6C42_u9020_u6210_u7684UI_u7EBF_u7A0B_u963B_u585E_u95EE_u9898" class="headerlink" title="5.2 同步Ajax请求造成的UI线程阻塞问题"></a>5.2 同步Ajax请求造成的UI线程阻塞问题</h4><p>一个浏览器嘛，他分为两个引擎，一个是js引擎用来解析你的js代码，比方说chrome的js引擎是v8，UI引擎是webkit，一个浏览器么，一个js引擎，一个ui引擎。这两个是没法同时进行的。一个运行的时候，他会阻塞吊另一个。什么意思呢。发送同步请求的时候，比如2秒钟的时候，js引擎要工作2s钟的时间，他会把ui引擎给阻塞掉，所以gif图片他是需要ui引擎来渲染的，所以他会阻塞掉的。（阻塞时，js，animate照常运行，但是页面呈现出的是2s后的效果）。为什么我们平时感受不到js引擎把UI引擎给阻塞掉了？因为同步的代码是非常快的。第一个例子执行100万次才10几毫秒，所以你感受不到。但是2s种你就能做好多事情。</p>
<h4 id="5-3__u4E3AAjax_u8BBE_u7F6E_u65F6_u95F4_u8D85_u65F6"><a href="#5-3__u4E3AAjax_u8BBE_u7F6E_u65F6_u95F4_u8D85_u65F6" class="headerlink" title="5.3 为Ajax设置时间超时"></a>5.3 为Ajax设置时间超时</h4><p>参考Ajax全局配置章节。</p>
<h4 id="5-4__u5224_u65ADerror_u7C7B_u578B"><a href="#5-4__u5224_u65ADerror_u7C7B_u578B" class="headerlink" title="5.4 判断error类型"></a>5.4 判断error类型</h4><p>error的类型可能有：<br>timeout 超时<br>error  获取不到具体错误（请求时浏览器刷新报error错误）<br>notmodified 返回304<br>parsererror 解析xml或json错误<br>abort 请求取消</p>
<h3 id="6__u6269_u5C55_u77E5_u8BC6"><a href="#6__u6269_u5C55_u77E5_u8BC6" class="headerlink" title="6 扩展知识"></a>6 扩展知识</h3><ul>
<li>HTML5的XMLHttpRequest2</li>
<li>promise规范和jQuery的Deffered对象</li>
<li>pjax</li>
<li>跨域请求</li>
<li>Fetch</li>
</ul>
<h3 id="7__u53C2_u8003_u8D44_u6599"><a href="#7__u53C2_u8003_u8D44_u6599" class="headerlink" title="7 参考资料"></a>7 参考资料</h3><ul>
<li><a href="http://www.iqiyi.com/w_19rscqwj2d.html" target="_blank" rel="external">ajax全面解析</a></li>
<li><a href="http://sjpsega.iteye.com/blog/1729350" target="_blank" rel="external">原生ajax写法</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://iwuly.com/2015/02/01/ajax001/" data-id="cipmex6na000lanxvq4o0laxy" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ajax/">Ajax</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript/">javaScript</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/12/31/Written-in-2015/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          平凡之路——写在2015年的尾巴
        
      </div>
    </a>
  
  
    <a href="/2014/09/06/redraw-reflow/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">重绘(redraw)和重排(reflow)</div>
    </a>
  
</nav>

  
  
        <div class="ds-thread" data-thread-key="2015/02/01/ajax001/" data-title="Ajax" data-url="http://iwuly.com/2015/02/01/ajax001/">
        </div>
  
</article>



  <div id="duoshuo_thread">
    <script type="text/javascript">
        var duoshuoQuery = {short_name:'iwuly'};
        (function() {
            var ds = document.createElement('script');
            ds.type = 'text/javascript';ds.async = true;
            ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
            ds.charset = 'UTF-8';
            (document.getElementsByTagName('head')[0]
            || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
    </script>
  </div>

</section>
        
          <aside id="sidebar">
<div class="widget-wrap">
    <h3 class="widget-title" style="display:none;">公告</h3>
    <div class="widget">
        我的微信公众号，写点技术之外的文章，扫描关注，认识另一个我
        <img src="/css/images/gzh_erweima.jpg" style="width:100%;"/>
        <b>版权声明：</b>本博客原创文章使用<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/cn/" target="_blank">CC3.0授权协议</a>，署名-非商业性使用-禁止演绎。转载本博客文章须在开头位置著名原作者姓名以及原文链接，违反协议的转载将受到我本人的版权追责
    </div>
  </div>
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Ajax/" style="font-size: 13px; color: #6a6352">Ajax</a> <a href="/tags/web-实时通信/" style="font-size: 13px; color: #6a6352">web 实时通信</a> <a href="/tags/html/" style="font-size: 23px; color: #00f800">html</a> <a href="/tags/重排/" style="font-size: 13px; color: #6a6352">重排</a> <a href="/tags/mobile/" style="font-size: 13px; color: #6a6352">mobile</a> <a href="/tags/mongodb/" style="font-size: 13px; color: #6a6352">mongodb</a> <a href="/tags/跨域/" style="font-size: 13px; color: #6a6352">跨域</a> <a href="/tags/javaScript/" style="font-size: 13px; color: #6a6352">javaScript</a> <a href="/tags/畅想/" style="font-size: 13px; color: #6a6352">畅想</a> <a href="/tags/杂谈/" style="font-size: 13px; color: #6a6352">杂谈</a> <a href="/tags/设计模式/" style="font-size: 13px; color: #6a6352">设计模式</a> <a href="/tags/观察者模式/" style="font-size: 13px; color: #6a6352">观察者模式</a>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/">2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/">2014</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/02/12/mongodb-base/">MongoDB 收藏夹</a>
          </li>
        
          <li>
            <a href="/2016/01/28/pit-in-mobile-development/">移动端开发中遇到的那些坑</a>
          </li>
        
          <li>
            <a href="/2016/01/20/web-socket/">web 实时通信与跨文档通信</a>
          </li>
        
          <li>
            <a href="/2016/01/03/Design-Patterns-Observer/">设计模式之观察者模式</a>
          </li>
        
          <li>
            <a href="/2015/12/31/Written-in-2015/">平凡之路——写在2015年的尾巴</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>

        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 iwuly<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  <div class="mobile-nav-box">

  
    <a href="/" class="mobile-nav-link">主页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/snippets" class="mobile-nav-link">实验室</a>
  
    <a href="/about" class="mobile-nav-link">关于我</a>
  
    <a href="/links" class="mobile-nav-link">友链</a>
  
  </div>
</nav>

    

<script src="//libs.useso.com/js/jquery/2.1.0/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>





  </div>
</body>
</html>